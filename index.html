<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apna Doctor Live</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    
    <style>
        :root { --primary: #3498db; --secondary: #2ecc71; --light: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--light); margin: 0; text-align: right; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 85%; max-width: 400px; margin: 20px auto; display: none; }
        .active { display: block; }
        .btn { width: 100%; padding: 12px; margin: 10px 0; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .btn-blue { background: var(--primary); color: white; }
        .btn-green { background: var(--secondary); color: white; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        .list-item { background: white; padding: 15px; margin: 10px; border-radius: 10px; border-right: 5px solid var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .header { background: var(--primary); color: white; padding: 15px; font-size: 20px; text-align: center; }
    </style>
</head>
<body>

    <div id="startScreen" class="card active">
        <h2>اپنا ڈاکٹر (Live)</h2>
        <button class="btn btn-blue" onclick="showForm('doctor')">میں ڈاکٹر ہوں</button>
        <button class="btn btn-green" onclick="showForm('public')">میں مریض ہوں</button>
    </div>

    <div id="docForm" class="card">
        <h3>ڈاکٹر رجسٹریشن</h3>
        <input type="text" id="dName" placeholder="آپ کا نام">
        <input type="text" id="dSpec" placeholder="ماہرِ (مثلاً بچوں کے ڈاکٹر)">
        <input type="tel" id="dPhone" placeholder="فون نمبر">
        <button class="btn btn-blue" onclick="registerUser('doctors')">اکاؤنٹ بنائیں</button>
    </div>

    <div id="pubForm" class="card">
        <h3>مریض رجسٹریشن</h3>
        <input type="text" id="pName" placeholder="آپ کا نام">
        <input type="tel" id="pPhone" placeholder="فون نمبر">
        <button class="btn btn-green" onclick="registerUser('patients')">رجسٹر ہوں</button>
    </div>

    <div id="docDash" style="display:none;">
        <div class="header">ڈاکٹر ڈیش بورڈ - مریضوں کی لسٹ</div>
        <div id="patientsList" style="padding:10px;"></div>
    </div>

    <div id="pubDash" style="display:none;">
        <div class="header">مریض ڈیش بورڈ - دستیاب ڈاکٹرز</div>
        <div id="doctorsList" style="padding:10px;"></div>
    </div>

    <script>
        // آپ کا اصلی کنکشن لنک
        const firebaseConfig = {
            apiKey: "AIzaSyDVJq00WDiMIZTuhaZnGKLeqLoBhOAUgWc",
            authDomain: "apna-doctor-d928f.firebaseapp.com",
            databaseURL: "https://apna-doctor-d928f-default-rtdb.firebaseio.com",
            projectId: "apna-doctor-d928f",
            appId: "1:488555434869:web:2f707ea67409e52ecd793c"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function showForm(role) {
            document.getElementById('startScreen').classList.remove('active');
            if(role === 'doctor') document.getElementById('docForm').classList.add('active');
            else document.getElementById('pubForm').classList.add('active');
        }

        function registerUser(type) {
            let name = (type === 'doctors') ? document.getElementById('dName').value : document.getElementById('pName').value;
            let phone = (type === 'doctors') ? document.getElementById('dPhone').value : document.getElementById('pPhone').value;
            let spec = (type === 'doctors') ? document.getElementById('dSpec').value : "";

            if(!name || !phone) { alert("براہ کرم نام اور نمبر لکھیں!"); return; }

            let data = { name: name, phone: phone };
            if(spec) data.spec = spec;

            // ڈیٹا بیس میں سیو کرنا
            db.ref(type).push(data).then(() => {
                document.getElementById('docForm').classList.remove('active');
                document.getElementById('pubForm').classList.remove('active');
                loadDash(type === 'doctors' ? 'doctor' : 'patient');
            }).catch(err => alert("ایرر: " + err.message));
        }

        function loadDash(role) {
            if(role === 'doctor') {
                document.getElementById('docDash').style.display = 'block';
                db.ref('patients').on('value', (snap) => {
                    let html = '';
                    snap.forEach(child => {
                        html += `<div class="list-item"><b>مریض: ${child.val().name}</b><br>فون: ${child.val().phone}</div>`;
                    });
                    document.getElementById('patientsList').innerHTML = html || 'کوئی مریض آن لائن نہیں';
                });
            } else {
                document.getElementById('pubDash').style.display = 'block';
                db.ref('doctors').on('value', (snap) => {
                    let html = '';
                    snap.forEach(child => {
                        html += `<div class="list-item"><b>ڈاکٹر: ${child.val().name}</b><br>ماہر: ${child.val().spec}<br>فون: ${child.val().phone}</div>`;
                    });
                    document.getElementById('doctorsList').innerHTML = html || 'کوئی ڈاکٹر دستیاب نہیں';
                });
            }
        }
    </script>
</body>
</html>
